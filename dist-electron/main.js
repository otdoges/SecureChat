"use strict";const e=require("electron"),l=require("path");function d(n){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(n){for(const o in n)if(o!=="default"){const s=Object.getOwnPropertyDescriptor(n,o);Object.defineProperty(t,o,s.get?s:{enumerable:!0,get:()=>n[o]})}}return t.default=n,Object.freeze(t)}const i=d(l);let a=null;const r=()=>{console.log("Creating window..."),console.log("Current directory:",__dirname);const n=i.join(__dirname,"preload.js");console.log("Preload path:",n),a=new e.BrowserWindow({width:1280,height:800,minWidth:940,minHeight:600,backgroundColor:"#36393f",webPreferences:{preload:n,nodeIntegration:!1,contextIsolation:!0,sandbox:!1,webSecurity:!0},frame:!0,titleBarStyle:"hidden",titleBarOverlay:{color:"#202225",symbolColor:"#dcddde",height:32}}),e.session.defaultSession.webRequest.onHeadersReceived((t,o)=>{o({responseHeaders:{...t.responseHeaders,"Content-Security-Policy":["default-src 'self' https://api.supabase.io; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self' https://api.supabase.io wss://*.supabase.co;"]}})}),process.env.NODE_ENV==="development"||!e.app.isPackaged?(a.loadURL("http://localhost:3000"),a.webContents.openDevTools(),a.webContents.on("did-fail-load",(t,o,s,c)=>{o===-6&&(console.log("Page not found, loading default index.html"),a.loadFile(i.join(__dirname,"..","..","index.html")))})):a.loadFile(i.join(__dirname,"../dist/index.html")),a.webContents.setWindowOpenHandler(({url:t})=>(e.shell.openExternal(t),{action:"deny"}))};e.app.whenReady().then(()=>{r()});e.app.on("window-all-closed",()=>{process.platform!=="darwin"&&e.app.quit()});e.app.on("activate",()=>{e.BrowserWindow.getAllWindows().length===0&&r()});e.ipcMain.handle("app:version",()=>e.app.getVersion());
